var ppStore=function(){"use strict";function f(a,n){n=n||"LOG";var i=window.console;return void 0===i?function(){}:function(e,t,o){a&&(t=3===arguments.length?"("+t+")":(o=t,""),void 0!==i[e]?i[e](n+t+":"+o):i.log(n+t+"["+e+"]: "+o))}}var h=0,u=/[^a-z0-9_\/]/gi,g=/[^a-z0-9_]/gi;function d(e){e=e||{};var t,o={swf_url:"storage.swf",namespace:"SwfStore",policyVer:1,debug:!1,timeout:10,onready:null,onerror:null};for(t in o)o.hasOwnProperty(t)&&(e.hasOwnProperty(t)||(e[t]=o[t]));if(e.namespace=e.namespace.replace(u,"_"),window.SwfStore[e.namespace])throw"There is already an instance of SwfStore using the '"+e.namespace+"' namespace. Use that instance or specify an alternate namespace in the config.";function a(){return"SwfStore_"+e.namespace.replace(g,"_")+"_"+h++}var n=f((this.config=e).debug,"SwfStore-"+e.namespace);this.log=function(e,t,o){n(e,t="SwfStore"===t?"swf":t,o)},this.log("info","js","Initializing..."),d[e.namespace]=this;var i,r,s=(i=e.debug,r=document.createElement("div"),document.body.appendChild(r),r.id=a(),i||(r.style.position="absolute",r.style.top="-2000px",r.style.left="-2000px"),r),c=a(),l="namespace="+encodeURIComponent(e.namespace)+"&policyVer="+e.policyVer;s.innerHTML='<object height="100" width="500" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+c+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">   <param value="'+e.swf_url+'" name="movie">   <param value="'+l+'" name="FlashVars">   <param value="always" name="allowScriptAccess">   <embed height="375" align="middle" width="500" pluginspage="//www.macromedia.com/go/getflashplayer" flashvars="'+l+'" type="application/x-shockwave-flash" allowscriptaccess="always" quality="high" loop="false" play="true" name="'+c+'" bgcolor="#ffffff" src="'+e.swf_url+'"></object>',this.swf=document[c]||window[c],this._timeout=setTimeout(function(){d[e.namespace].onerror(new Error(e.swf_url+" failed to load within "+e.timeout+" seconds."),"js")},1e3*e.timeout)}function o(e){if("function"==typeof e)throw new Error("SwfStore Error: Functions cannot be used as keys or values.")}d.prototype={ready:!1,set:function(e,t){this._checkReady(),o(e),o(t),null==t?this.swf.clear(e):this.swf.set(e,t)},get:function(e){this._checkReady(),o(e);var t=this.swf.get(e);return null===t?void 0:t},getAll:function(){this._checkReady();for(var e,t=this.swf.getAll(),o={},a=0,n=t.length;a<n;a++)o[(e=t[a]).key]=e.value;return o},clearAll:function(){var e=this.getAll();for(var t in e)e.hasOwnProperty(t)&&this.clear(t)},clear:function(e){this._checkReady(),o(e),this.swf.clear(e)},_checkReady:function(){if(!this.ready)throw"SwfStore is not yet finished initializing. Pass a config.onready callback or wait until this.ready is true before trying to use a SwfStore instance."},onload:function(){var t=this;setTimeout(function(){clearTimeout(t._timeout);try{t.swf.callAS()&&(t.ready=!0,t.log("info","js","swfStore is Ready!"),t.config.onready&&t.config.onready.call(t))}catch(e){t.log("warn","js","flash is ready,but can not call AS method, maybe your DOMAIN is NOT add into policy.txt.")}},0)},checkCrossDomain:function(){this.log("info","js","js checkCrossDomain is called ...");var e=!1,t=this.config.swf_url;return/\/\//i.test(t)&&-1==t.indexOf(window.location.host)&&(e=!0),e},onerror:function(e,t){clearTimeout(this._timeout),e instanceof Error||(e=new Error(e)),this.log("error",t||"swf",e.message),this.config.onerror&&this.config.onerror(e)}},window.SwfStore=d;var n=/[^a-z0-9_\/]/gi,i=window.localStorage;function e(e){e=e||{};var t,o={namespace:"localStore",debug:!1};for(t in o)o.hasOwnProperty(t)&&(e.hasOwnProperty(t)||(e[t]=o[t]));if(e.namespace=e.namespace.replace(n,"_"),this.keyPre=e.namespace+"_",this.config=e,this.log=f(e.debug,"localStore-"+e.namespace),this.log("info","Initializing..."),i){try{var a=Math.random().toString(36).slice(2,8);i.setItem(a,"test insert val"),i.removeItem(a)}catch(e){return void this.log("warn","localStorage is unusable:"+e.message)}this.ready=!0,this.log("info","localStorage is ready!")}else this.log("warn","localStorage can not available!")}e.prototype={ready:!1,set:function(t,e){if(this._checkReady(),null==e)this.clear(t);else try{t=this.keyPre+t,i.setItem(t,e),this.log("info","set key=["+t+"],val=["+e+"].")}catch(e){this.log("warn","set key=["+t+"] fail:"+e.message)}},get:function(t){this._checkReady();try{t=this.keyPre+t;var e=i.getItem(t);return this.log("info","get key=["+t+"],return value=["+e+"]."),null===e?void 0:e}catch(e){return void this.log("warn","get key=["+t+"] fail:"+e.message)}},clear:function(t){this._checkReady();try{t=this.keyPre+t,i.removeItem(t),this.log("info","clear key=["+t+"]")}catch(e){this.log("warn","clear key=["+t+"] fail:"+e.message)}},_checkReady:function(){if(!this.ready)throw"the localStorage is not available or localStorage is unusable"}};var s=/[^a-z0-9_\/]/gi;function t(e){e=e||{};var t,o={namespace:"CookieStore",debug:!1,path:"/",domain:".58.com",expires:3650};for(t in o)o.hasOwnProperty(t)&&(e.hasOwnProperty(t)||(e[t]=o[t]));e.namespace=e.namespace.replace(s,"_"),this.keyPre=e.namespace+"_",this.config=e,this.log=f(e.debug,"CookieStore-"+e.namespace),this.log("info","Initializing...");var a=Math.random().toString(36).slice(2,8),n="test insert val",i=a+"="+n+";path="+e.path+";domain="+e.domain;try{if(document.cookie=i,-1==document.cookie.indexOf(a))return void this.log("warn","CookieStore is unusable:can not read store cookie!!!");var r=new Date;r.setTime(-1*r.getTime()),document.cookie=a+"="+n+"; expires="+r.toGMTString()+";path="+e.path+";domain="+e.domain}catch(e){return void this.log("warn","CookieStore is unusable:"+e.message)}this.ready=!0,this.log("info","CookieStore is ready!")}function c(e){return"string"==typeof e&&""!==e}var l=decodeURIComponent,m=encodeURIComponent;function y(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}var a="ppStore",r=!(t.prototype={ready:!1,set:function(t,o,e){this._checkReady();try{var a=(e=e||this.config||{}).expires;null==o&&(a=-1),t=this.keyPre+t;var n=e.domain,i=e.path;e.raw||(o=m(String(o)));var r=t+"="+o,s=a;"number"==typeof s&&(s=new Date).setDate(s.getDate()+a),s instanceof Date&&(r+="; expires="+s.toUTCString()),c(n)&&(r+="; domain="+n),c(i)&&(r+="; path="+i),e.secure&&(r+="; secure"),document.cookie=r,this.log("info","set key=["+t+"],val=["+o+"].")}catch(e){this.log("warn","set key=["+t+"],val=["+o+"] fail:"+e.message)}},get:function(t,e){this._checkReady(),t=this.keyPre+t,e=e||this.config||{};try{var o,a,n=document.cookie,i={},r=n.split(";");if(""!==r[0])for(var s=0;s<r.length;++s)a=y((o=r[s].split("="))[0]),c=y(o[1]),a===t&&(i[a]=e.raw?o[1]:l(c))}catch(e){return this.log("warn","get key=["+t+"] fail:"+e.message),"URI malformed"==e.message?(this.log("warn","cookie value can not decode, return stored value"),c):void 0}var c=i[t];return this.log("info","get key=["+t+"],return value=["+c+"]."),c},clear:function(e){this._checkReady(),this.log("info","clear key=["+e+"]"),this.set(e,null)},_checkReady:function(){if(!this.ready)throw"the CookieStore is not available or CookieStore is unusable"}}),p={namespace:a,debug:r,swf_url:"//img.58cdn.com.cn/ucenter/my/storage.swf?v=1",policyVer:2,onready:function(){},onerror:function(){}},w={namespace:a,debug:r},v={namespace:a,debug:r,path:"/",domain:".58.com",expires:3650};var k=f(r,a);k("info","store Initializing ---");var S=function(e,n){for(var i={},t=0,o=e.length;t<o;t++){var a=e[t].name,r=e[t].engin,s=e[t].config;i[a]=new r(s)}return{set:function(e,t){for(var o in i){var a=i[o];a.ready?a.set(e,t):n("info","store["+o+"] is not ready when setting.")}},get:function(e){var t={};for(var o in i){var a=i[o];a.ready?t[o]=a.get(e):t[o]=""}return t},clear:function(e){for(var t in i){var o=i[t];o.ready?o.clear(e):n("info","store["+t+"] is not ready when clearing.")}}}}([{name:"flashStore",engin:d,config:p},{name:"localStore",engin:e,config:w},{name:"cookieStore",engin:t,config:v}],k);return k("info","store Initializing end."),S}();